import com.qalight.javacourse.service.WordCounterServiceImpl;
import org.junit.Assert;
import org.junit.Test;

public class WordCounterServiceImplTest {

    @Test
    public void testGetWordCounterResult_okUrl_KeyAscSort_JsonResp() {
        // given
        final String clientRequestUrl = "http://95.158.60.148:8008/kpl/testingPage.html";
        final String sortingParam = "KEY_ASCENDING";
        final String dataTypeResponse = "JSON";
        final String expectedResult = "{\"success\":true,\"response\":[[{\"hash\":97,\"key\":\"a\",\"value\":2},{\"hash\":96726,\"key\":\"and\",\"value\":2},{\"hash\":93030097,\"key\":\"apple\",\"value\":1},{\"hash\":3122,\"key\":\"as\",\"value\":1,\"next\":{\"hash\":1074,\"key\":\"в\",\"value\":2,\"next\":{\"hash\":1039806770,\"key\":\"текст\",\"value\":1}}},{\"hash\":3019778,\"key\":\"been\",\"value\":1},{\"hash\":-1072081724,\"key\":\"beginning\",\"value\":1},{\"hash\":3029703,\"key\":\"book\",\"value\":1,\"next\":{\"hash\":33076423,\"key\":\"всех\",\"value\":1,\"next\":{\"hash\":-1268289081,\"key\":\"нормалізації\",\"value\":1}}},{\"hash\":1564206610,\"key\":\"character\",\"value\":1,\"next\":{\"hash\":617137426,\"key\":\"становится\",\"value\":1}},{\"hash\":1245438033,\"key\":\"characters\",\"value\":1,\"next\":{\"hash\":-1405723055,\"key\":\"закодировать\",\"value\":1}},{\"hash\":707888742,\"key\":\"computing-industry\",\"value\":1,\"next\":{\"hash\":3357542,\"key\":\"more\",\"value\":1}},{\"hash\":1032937741,\"key\":\"conjunctionwith\",\"value\":1},{\"hash\":-332950906,\"key\":\"consortium\",\"value\":1,\"next\":{\"hash\":-1633678458,\"key\":\"таблиць\",\"value\":1}},{\"hash\":-351764541,\"key\":\"covering\",\"value\":1,\"next\":{\"hash\":33103811,\"key\":\"году\",\"value\":1}},{\"hash\":-80733044,\"key\":\"developed\",\"value\":1},{\"hash\":-1603782120,\"key\":\"english\",\"value\":1},{\"hash\":3149044,\"key\":\"form\",\"value\":1},{\"hash\":103067,\"key\":\"has\",\"value\":2},{\"hash\":-1443541794,\"key\":\"high-light\",\"value\":1},{\"hash\":3365,\"key\":\"in\",\"value\":2,\"next\":{\"hash\":2106950437,\"key\":\"разных\",\"value\":1}},{\"hash\":104415,\"key\":\"inc\",\"value\":1},{\"hash\":3370,\"key\":\"is\",\"value\":1},{\"hash\":-1109904801,\"key\":\"latest\",\"value\":1},{\"hash\":3357542,\"key\":\"more\",\"value\":1},{\"hash\":3373752,\"key\":\"name\",\"value\":2,\"next\":{\"hash\":1068728,\"key\":\"для\",\"value\":1}},{\"hash\":3543,\"key\":\"of\",\"value\":2},{\"hash\":3433147,\"key\":\"page\",\"value\":2},{\"hash\":1447425963,\"key\":\"published\",\"value\":1},{\"hash\":1647065627,\"key\":\"repertoire\",\"value\":1},{\"hash\":108521650,\"key\":\"risen\",\"value\":1,\"next\":{\"hash\":1044498098,\"key\":\"число\",\"value\":1}},{\"hash\":1926511580,\"key\":\"scripts\",\"value\":1},{\"hash\":-906261105,\"key\":\"second\",\"value\":1},{\"hash\":113763,\"key\":\"set\",\"value\":1},{\"hash\":109442495,\"key\":\"since\",\"value\":1},{\"hash\":1312641152,\"key\":\"standard\",\"value\":2,\"next\":{\"hash\":901557632,\"key\":\"спец-символов\",\"value\":1}},{\"hash\":114253,\"key\":\"sun\",\"value\":1},{\"hash\":-613938469,\"key\":\"supporting\",\"value\":1},{\"hash\":-1743411762,\"key\":\"symbols\",\"value\":1,\"next\":{\"hash\":-676536882,\"key\":\"складається\",\"value\":1,\"next\":{\"hash\":-1117061682,\"key\":\"компютерних\",\"value\":1}}},{\"hash\":-1737405355,\"key\":\"systems\",\"value\":1,\"next\":{\"hash\":805080917,\"key\":\"юникода\",\"value\":1,\"next\":{\"hash\":-1275837099,\"key\":\"властивостей\",\"value\":1}}},{\"hash\":-1422419673,\"key\":\"testing\",\"value\":2},{\"hash\":3556635,\"key\":\"text\",\"value\":1,\"next\":{\"hash\":1647065627,\"key\":\"repertoire\",\"value\":1}},{\"hash\":3558807,\"key\":\"than\",\"value\":1,\"next\":{\"hash\":329249175,\"key\":\"стандартів\",\"value\":1,\"next\":{\"hash\":-302096489,\"key\":\"комплект\",\"value\":1}}},{\"hash\":114800,\"key\":\"the\",\"value\":3,\"next\":{\"hash\":1379580784,\"key\":\"розроблений\",\"value\":1,\"next\":{\"hash\":-41227408,\"key\":\"посилань\",\"value\":1}}},{\"hash\":-1629331701,\"key\":\"thenbspunicodenbspstandard\",\"value\":1},{\"hash\":110326007,\"key\":\"there\",\"value\":1},{\"hash\":1106799874,\"key\":\"theuniversal\",\"value\":1,\"next\":{\"hash\":3019778,\"key\":\"been\",\"value\":1}},{\"hash\":-287009735,\"key\":\"unicode\",\"value\":7},{\"hash\":1158383351,\"key\":\"unicodecontains\",\"value\":1,\"next\":{\"hash\":110326007,\"key\":\"there\",\"value\":1}},{\"hash\":236801014,\"key\":\"various\",\"value\":1},{\"hash\":351602733,\"key\":\"version\",\"value\":1,\"next\":{\"hash\":-774418643,\"key\":\"комплекту\",\"value\":2}},{\"hash\":117480,\"key\":\"was\",\"value\":1},{\"hash\":-782072253,\"key\":\"worlds\",\"value\":1},{\"hash\":1602987863,\"key\":\"writing\",\"value\":1},{\"hash\":1297077348,\"key\":\"алфавита\",\"value\":1},{\"hash\":33012930,\"key\":\"англ\",\"value\":3},{\"hash\":-834353672,\"key\":\"асортименту\",\"value\":1},{\"hash\":869231918,\"key\":\"большое\",\"value\":1,\"next\":{\"hash\":1610114606,\"key\":\"чисто-математические\",\"value\":1,\"next\":{\"hash\":34862,\"key\":\"та\",\"value\":2,\"next\":{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}}}}},{\"hash\":1024517553,\"key\":\"буквы\",\"value\":1},{\"hash\":1074,\"key\":\"в\",\"value\":2,\"next\":{\"hash\":1039806770,\"key\":\"текст\",\"value\":1}},{\"hash\":1503478917,\"key\":\"верхній\",\"value\":1},{\"hash\":-1275837099,\"key\":\"властивостей\",\"value\":1},{\"hash\":33076423,\"key\":\"всех\",\"value\":1,\"next\":{\"hash\":-1268289081,\"key\":\"нормалізації\",\"value\":1}},{\"hash\":33103811,\"key\":\"году\",\"value\":1},{\"hash\":-1441253918,\"key\":\"греческого\",\"value\":1},{\"hash\":1026733372,\"key\":\"даних\",\"value\":1},{\"hash\":723850357,\"key\":\"декомпозиції\",\"value\":1},{\"hash\":1068728,\"key\":\"для\",\"value\":1},{\"hash\":1436358824,\"key\":\"довідкових\",\"value\":1},{\"hash\":-1259286410,\"key\":\"документах\",\"value\":1},{\"hash\":1778577899,\"key\":\"других\",\"value\":1},{\"hash\":1079,\"key\":\"з\",\"value\":1},{\"hash\":1865473031,\"key\":\"забезпечити\",\"value\":1},{\"hash\":-1405723055,\"key\":\"закодировать\",\"value\":1},{\"hash\":1029880746,\"key\":\"знаки\",\"value\":1,\"next\":{\"hash\":1037317034,\"key\":\"почти\",\"value\":1}},{\"hash\":935303561,\"key\":\"зображення\",\"value\":2},{\"hash\":-1264635284,\"key\":\"зіставлення\",\"value\":1},{\"hash\":1080,\"key\":\"и\",\"value\":2,\"next\":{\"hash\":31669560,\"key\":\"предложен\",\"value\":1}},{\"hash\":-740627546,\"key\":\"иероглифы\",\"value\":1},{\"hash\":34559,\"key\":\"из\",\"value\":1},{\"hash\":708472733,\"key\":\"кириллицы\",\"value\":1,\"next\":{\"hash\":-2137750627,\"key\":\"наприклад\",\"value\":1}},{\"hash\":-2042229147,\"key\":\"китайские\",\"value\":1},{\"hash\":1484929682,\"key\":\"кодирования\",\"value\":1},{\"hash\":259919951,\"key\":\"кодових\",\"value\":1},{\"hash\":259927552,\"key\":\"кодовых\",\"value\":1},{\"hash\":821569606,\"key\":\"кодування\",\"value\":3},{\"hash\":-302096489,\"key\":\"комплект\",\"value\":1},{\"hash\":-774418643,\"key\":\"комплекту\",\"value\":2},{\"hash\":-1117061682,\"key\":\"компютерних\",\"value\":1},{\"hash\":1082688445,\"key\":\"консорциум\",\"value\":1},{\"hash\":2065988943,\"key\":\"латиницы\",\"value\":1,\"next\":{\"hash\":259919951,\"key\":\"кодових\",\"value\":1}},{\"hash\":-59324188,\"key\":\"методології\",\"value\":1},{\"hash\":1034502329,\"key\":\"могут\",\"value\":1,\"next\":{\"hash\":2012768441,\"key\":\"символы\",\"value\":1}},{\"hash\":34707,\"key\":\"на\",\"value\":2},{\"hash\":2020918647,\"key\":\"набору\",\"value\":1},{\"hash\":-2137750627,\"key\":\"наприклад\",\"value\":1},{\"hash\":2023677879,\"key\":\"некоммерческой\",\"value\":1},{\"hash\":1265991651,\"key\":\"ненужным\",\"value\":1},{\"hash\":2028455202,\"key\":\"нижній\",\"value\":1},{\"hash\":-1268289081,\"key\":\"нормалізації\",\"value\":1},{\"hash\":-42949031,\"key\":\"организацией\",\"value\":1,\"next\":{\"hash\":2092908377,\"key\":\"правил\",\"value\":1}},{\"hash\":1036646386,\"key\":\"очень\",\"value\":1},{\"hash\":2078943552,\"key\":\"переключение\",\"value\":1},{\"hash\":41579759,\"key\":\"писемностей\",\"value\":1},{\"hash\":-983839715,\"key\":\"письменностей\",\"value\":1},{\"hash\":1841138442,\"key\":\"письменных\",\"value\":1},{\"hash\":-1733527799,\"key\":\"позволяет\",\"value\":1},{\"hash\":557562319,\"key\":\"позволяющий\",\"value\":1},{\"hash\":-41227408,\"key\":\"посилань\",\"value\":1},{\"hash\":1037317034,\"key\":\"почти\",\"value\":1},{\"hash\":2092908377,\"key\":\"правил\",\"value\":1},{\"hash\":31669560,\"key\":\"предложен\",\"value\":1},{\"hash\":1508547221,\"key\":\"представить\",\"value\":1},{\"hash\":-1972631874,\"key\":\"представлення\",\"value\":1},{\"hash\":1079399,\"key\":\"при\",\"value\":1},{\"hash\":252595772,\"key\":\"применение\",\"value\":1,\"next\":{\"hash\":1026733372,\"key\":\"даних\",\"value\":1}},{\"hash\":-231771929,\"key\":\"промисловий\",\"value\":1},{\"hash\":2106950437,\"key\":\"разных\",\"value\":1},{\"hash\":1032113539,\"key\":\"регістр\",\"value\":1},{\"hash\":80122474,\"key\":\"рендерингу\",\"value\":1},{\"hash\":979911260,\"key\":\"розкладка\",\"value\":1},{\"hash\":1379580784,\"key\":\"розроблений\",\"value\":1,\"next\":{\"hash\":-41227408,\"key\":\"посилань\",\"value\":1}},{\"hash\":1445215505,\"key\":\"русском\",\"value\":1},{\"hash\":1038826637,\"key\":\"світу\",\"value\":1},{\"hash\":-2029302667,\"key\":\"символов\",\"value\":2,\"next\":{\"hash\":723850357,\"key\":\"декомпозиції\",\"value\":1}},{\"hash\":2012768441,\"key\":\"символы\",\"value\":1},{\"hash\":-2029303443,\"key\":\"символів\",\"value\":6},{\"hash\":-676536882,\"key\":\"складається\",\"value\":1,\"next\":{\"hash\":-1117061682,\"key\":\"компютерних\",\"value\":1}},{\"hash\":269427991,\"key\":\"соседствовать\",\"value\":1},{\"hash\":901557632,\"key\":\"спец-символов\",\"value\":1},{\"hash\":370307170,\"key\":\"спеціальних\",\"value\":1},{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}},{\"hash\":-2077833654,\"key\":\"стандарт\",\"value\":3},{\"hash\":10620902,\"key\":\"стандарта\",\"value\":1},{\"hash\":329249175,\"key\":\"стандартів\",\"value\":1,\"next\":{\"hash\":-302096489,\"key\":\"комплект\",\"value\":1}},{\"hash\":617137426,\"key\":\"становится\",\"value\":1},{\"hash\":-1992257574,\"key\":\"страниц\",\"value\":1},{\"hash\":34862,\"key\":\"та\",\"value\":2,\"next\":{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}}},{\"hash\":-1633678458,\"key\":\"таблиць\",\"value\":1},{\"hash\":1039661102,\"key\":\"таких\",\"value\":1},{\"hash\":1039806770,\"key\":\"текст\",\"value\":1},{\"hash\":33541739,\"key\":\"тест\",\"value\":1},{\"hash\":929892735,\"key\":\"українською\",\"value\":1},{\"hash\":-1249432465,\"key\":\"уніфіковане\",\"value\":1},{\"hash\":33583501,\"key\":\"усіх\",\"value\":1,\"next\":{\"hash\":1038826637,\"key\":\"світу\",\"value\":1}},{\"hash\":-2073376832,\"key\":\"файлів\",\"value\":1},{\"hash\":34991,\"key\":\"це\",\"value\":1},{\"hash\":-2131828867,\"key\":\"цифрове\",\"value\":1},{\"hash\":1044498098,\"key\":\"число\",\"value\":1},{\"hash\":1610114606,\"key\":\"чисто-математические\",\"value\":1,\"next\":{\"hash\":34862,\"key\":\"та\",\"value\":2,\"next\":{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}}}},{\"hash\":1088940,\"key\":\"щоб\",\"value\":1},{\"hash\":1050360815,\"key\":\"этого\",\"value\":1,\"next\":{\"hash\":41579759,\"key\":\"писемностей\",\"value\":1}},{\"hash\":33882646,\"key\":\"этом\",\"value\":1},{\"hash\":-1775114666,\"key\":\"юникод\",\"value\":1,\"next\":{\"hash\":1110,\"key\":\"і\",\"value\":2}},{\"hash\":805080917,\"key\":\"юникода\",\"value\":1,\"next\":{\"hash\":-1275837099,\"key\":\"властивостей\",\"value\":1}},{\"hash\":-1774221898,\"key\":\"юнікод\",\"value\":2},{\"hash\":-1751463791,\"key\":\"языков\",\"value\":1},{\"hash\":35275,\"key\":\"як\",\"value\":1},{\"hash\":1110,\"key\":\"і\",\"value\":2}]],\"listUsersUrls\":[\"http://95.158.60.148:8008/kpl/testingPage.html\"],\"dataTypeResponse\":\"JSON\"}"; // when
        WordCounterServiceImpl wordCounterService = new WordCounterServiceImpl();
        String actualResult = wordCounterService.getWordCounterResult(clientRequestUrl, sortingParam, dataTypeResponse);

        // then
        Assert.assertEquals(expectedResult, actualResult);
    }

    @Test
    public void testGetWordCounterResult_emptyUrl_KeyAscSort_JsonResp() {
        // given
        final String clientRequestUrl = "";
        final String sortingParam = "KEY_ASCENDING";
        final String dataTypeResponse = "JSON";
        final Exception expectedException = new IllegalArgumentException("str is null or empty");

        // when
        WordCounterServiceImpl wordCounterService = new WordCounterServiceImpl();
        Exception actualException = null;
        try {
            wordCounterService.getWordCounterResult(clientRequestUrl, sortingParam, dataTypeResponse);
        } catch (IllegalArgumentException e) {
            actualException = e;
        }

        // then
        if (actualException != null) {
            Assert.assertEquals(expectedException.toString(), actualException.toString());
        } else {
            Assert.assertFalse(true);
        }
    }

    @Test
    public void testGetWordCounterResult_InvalidUrl_KeyAscSort_JsonResp() {
        // given
        final String clientRequestUrl = "http://95.158.60.148:8008/kpl/testingPageERROR.html";
        final String sortingParam = "KEY_ASCENDING";
        final String dataTypeResponse = "JSON";
        final String expctedExceptionString = "java.lang.RuntimeException: Can't connect to: http://95.158.60.148:8008/kpl/testingPageERROR.html";

        // when
        WordCounterServiceImpl wordCounterService = new WordCounterServiceImpl();
        Exception actualException = null;
        try {
            wordCounterService.getWordCounterResult(clientRequestUrl, sortingParam, dataTypeResponse);
        } catch (RuntimeException e) {
            actualException = e;
        }

        // then
        if (actualException != null) {
            Assert.assertEquals(expctedExceptionString, actualException.toString());
        } else {
            Assert.assertFalse(true);
        }
    }

    @Test
    public void testGetWordCounterResult_okUrl_KeyDescSort_JsonResp() {
        // given
        final String clientRequestUrl = "http://95.158.60.148:8008/kpl/testingPage.html";
        final String sortingParam = "KEY_DESCENDING";
        final String dataTypeResponse = "JSON";
        final String expectedResult = "{\"success\":true,\"response\":[[{\"hash\":1110,\"key\":\"і\",\"value\":2},{\"hash\":35275,\"key\":\"як\",\"value\":1},{\"hash\":-1751463791,\"key\":\"языков\",\"value\":1},{\"hash\":-1774221898,\"key\":\"юнікод\",\"value\":2},{\"hash\":805080917,\"key\":\"юникода\",\"value\":1,\"next\":{\"hash\":-1275837099,\"key\":\"властивостей\",\"value\":1}},{\"hash\":-1775114666,\"key\":\"юникод\",\"value\":1,\"next\":{\"hash\":1110,\"key\":\"і\",\"value\":2}},{\"hash\":33882646,\"key\":\"этом\",\"value\":1},{\"hash\":1050360815,\"key\":\"этого\",\"value\":1,\"next\":{\"hash\":41579759,\"key\":\"писемностей\",\"value\":1}},{\"hash\":1088940,\"key\":\"щоб\",\"value\":1},{\"hash\":1610114606,\"key\":\"чисто-математические\",\"value\":1,\"next\":{\"hash\":34862,\"key\":\"та\",\"value\":2,\"next\":{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}}}},{\"hash\":1044498098,\"key\":\"число\",\"value\":1},{\"hash\":-2131828867,\"key\":\"цифрове\",\"value\":1},{\"hash\":34991,\"key\":\"це\",\"value\":1},{\"hash\":-2073376832,\"key\":\"файлів\",\"value\":1},{\"hash\":33583501,\"key\":\"усіх\",\"value\":1,\"next\":{\"hash\":1038826637,\"key\":\"світу\",\"value\":1}},{\"hash\":-1249432465,\"key\":\"уніфіковане\",\"value\":1},{\"hash\":929892735,\"key\":\"українською\",\"value\":1},{\"hash\":33541739,\"key\":\"тест\",\"value\":1},{\"hash\":1039806770,\"key\":\"текст\",\"value\":1},{\"hash\":1039661102,\"key\":\"таких\",\"value\":1},{\"hash\":-1633678458,\"key\":\"таблиць\",\"value\":1},{\"hash\":34862,\"key\":\"та\",\"value\":2,\"next\":{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}}},{\"hash\":-1992257574,\"key\":\"страниц\",\"value\":1},{\"hash\":617137426,\"key\":\"становится\",\"value\":1},{\"hash\":329249175,\"key\":\"стандартів\",\"value\":1,\"next\":{\"hash\":-302096489,\"key\":\"комплект\",\"value\":1}},{\"hash\":10620902,\"key\":\"стандарта\",\"value\":1},{\"hash\":-2077833654,\"key\":\"стандарт\",\"value\":3},{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}},{\"hash\":370307170,\"key\":\"спеціальних\",\"value\":1},{\"hash\":901557632,\"key\":\"спец-символов\",\"value\":1},{\"hash\":269427991,\"key\":\"соседствовать\",\"value\":1},{\"hash\":-676536882,\"key\":\"складається\",\"value\":1,\"next\":{\"hash\":-1117061682,\"key\":\"компютерних\",\"value\":1}},{\"hash\":-2029303443,\"key\":\"символів\",\"value\":6},{\"hash\":2012768441,\"key\":\"символы\",\"value\":1},{\"hash\":-2029302667,\"key\":\"символов\",\"value\":2,\"next\":{\"hash\":723850357,\"key\":\"декомпозиції\",\"value\":1}},{\"hash\":1038826637,\"key\":\"світу\",\"value\":1},{\"hash\":1445215505,\"key\":\"русском\",\"value\":1},{\"hash\":1379580784,\"key\":\"розроблений\",\"value\":1,\"next\":{\"hash\":-41227408,\"key\":\"посилань\",\"value\":1}},{\"hash\":979911260,\"key\":\"розкладка\",\"value\":1},{\"hash\":80122474,\"key\":\"рендерингу\",\"value\":1},{\"hash\":1032113539,\"key\":\"регістр\",\"value\":1},{\"hash\":2106950437,\"key\":\"разных\",\"value\":1},{\"hash\":-231771929,\"key\":\"промисловий\",\"value\":1},{\"hash\":252595772,\"key\":\"применение\",\"value\":1,\"next\":{\"hash\":1026733372,\"key\":\"даних\",\"value\":1}},{\"hash\":1079399,\"key\":\"при\",\"value\":1},{\"hash\":-1972631874,\"key\":\"представлення\",\"value\":1},{\"hash\":1508547221,\"key\":\"представить\",\"value\":1},{\"hash\":31669560,\"key\":\"предложен\",\"value\":1},{\"hash\":2092908377,\"key\":\"правил\",\"value\":1},{\"hash\":1037317034,\"key\":\"почти\",\"value\":1},{\"hash\":-41227408,\"key\":\"посилань\",\"value\":1},{\"hash\":557562319,\"key\":\"позволяющий\",\"value\":1},{\"hash\":-1733527799,\"key\":\"позволяет\",\"value\":1},{\"hash\":1841138442,\"key\":\"письменных\",\"value\":1},{\"hash\":-983839715,\"key\":\"письменностей\",\"value\":1},{\"hash\":41579759,\"key\":\"писемностей\",\"value\":1},{\"hash\":2078943552,\"key\":\"переключение\",\"value\":1},{\"hash\":1036646386,\"key\":\"очень\",\"value\":1},{\"hash\":-42949031,\"key\":\"организацией\",\"value\":1,\"next\":{\"hash\":2092908377,\"key\":\"правил\",\"value\":1}},{\"hash\":-1268289081,\"key\":\"нормалізації\",\"value\":1},{\"hash\":2028455202,\"key\":\"нижній\",\"value\":1},{\"hash\":1265991651,\"key\":\"ненужным\",\"value\":1},{\"hash\":2023677879,\"key\":\"некоммерческой\",\"value\":1},{\"hash\":-2137750627,\"key\":\"наприклад\",\"value\":1},{\"hash\":2020918647,\"key\":\"набору\",\"value\":1},{\"hash\":34707,\"key\":\"на\",\"value\":2},{\"hash\":1034502329,\"key\":\"могут\",\"value\":1,\"next\":{\"hash\":2012768441,\"key\":\"символы\",\"value\":1}},{\"hash\":-59324188,\"key\":\"методології\",\"value\":1},{\"hash\":2065988943,\"key\":\"латиницы\",\"value\":1,\"next\":{\"hash\":259919951,\"key\":\"кодових\",\"value\":1}},{\"hash\":1082688445,\"key\":\"консорциум\",\"value\":1},{\"hash\":-1117061682,\"key\":\"компютерних\",\"value\":1},{\"hash\":-774418643,\"key\":\"комплекту\",\"value\":2},{\"hash\":-302096489,\"key\":\"комплект\",\"value\":1},{\"hash\":821569606,\"key\":\"кодування\",\"value\":3},{\"hash\":259927552,\"key\":\"кодовых\",\"value\":1},{\"hash\":259919951,\"key\":\"кодових\",\"value\":1},{\"hash\":1484929682,\"key\":\"кодирования\",\"value\":1},{\"hash\":-2042229147,\"key\":\"китайские\",\"value\":1},{\"hash\":708472733,\"key\":\"кириллицы\",\"value\":1,\"next\":{\"hash\":-2137750627,\"key\":\"наприклад\",\"value\":1}},{\"hash\":34559,\"key\":\"из\",\"value\":1},{\"hash\":-740627546,\"key\":\"иероглифы\",\"value\":1},{\"hash\":1080,\"key\":\"и\",\"value\":2,\"next\":{\"hash\":31669560,\"key\":\"предложен\",\"value\":1}},{\"hash\":-1264635284,\"key\":\"зіставлення\",\"value\":1},{\"hash\":935303561,\"key\":\"зображення\",\"value\":2},{\"hash\":1029880746,\"key\":\"знаки\",\"value\":1,\"next\":{\"hash\":1037317034,\"key\":\"почти\",\"value\":1}},{\"hash\":-1405723055,\"key\":\"закодировать\",\"value\":1},{\"hash\":1865473031,\"key\":\"забезпечити\",\"value\":1},{\"hash\":1079,\"key\":\"з\",\"value\":1},{\"hash\":1778577899,\"key\":\"других\",\"value\":1},{\"hash\":-1259286410,\"key\":\"документах\",\"value\":1},{\"hash\":1436358824,\"key\":\"довідкових\",\"value\":1},{\"hash\":1068728,\"key\":\"для\",\"value\":1},{\"hash\":723850357,\"key\":\"декомпозиції\",\"value\":1},{\"hash\":1026733372,\"key\":\"даних\",\"value\":1},{\"hash\":-1441253918,\"key\":\"греческого\",\"value\":1},{\"hash\":33103811,\"key\":\"году\",\"value\":1},{\"hash\":33076423,\"key\":\"всех\",\"value\":1,\"next\":{\"hash\":-1268289081,\"key\":\"нормалізації\",\"value\":1}},{\"hash\":-1275837099,\"key\":\"властивостей\",\"value\":1},{\"hash\":1503478917,\"key\":\"верхній\",\"value\":1},{\"hash\":1074,\"key\":\"в\",\"value\":2,\"next\":{\"hash\":1039806770,\"key\":\"текст\",\"value\":1}},{\"hash\":1024517553,\"key\":\"буквы\",\"value\":1},{\"hash\":869231918,\"key\":\"большое\",\"value\":1,\"next\":{\"hash\":1610114606,\"key\":\"чисто-математические\",\"value\":1,\"next\":{\"hash\":34862,\"key\":\"та\",\"value\":2,\"next\":{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}}}}},{\"hash\":-834353672,\"key\":\"асортименту\",\"value\":1},{\"hash\":33012930,\"key\":\"англ\",\"value\":3},{\"hash\":1297077348,\"key\":\"алфавита\",\"value\":1},{\"hash\":1602987863,\"key\":\"writing\",\"value\":1},{\"hash\":-782072253,\"key\":\"worlds\",\"value\":1},{\"hash\":117480,\"key\":\"was\",\"value\":1},{\"hash\":351602733,\"key\":\"version\",\"value\":1,\"next\":{\"hash\":-774418643,\"key\":\"комплекту\",\"value\":2}},{\"hash\":236801014,\"key\":\"various\",\"value\":1},{\"hash\":1158383351,\"key\":\"unicodecontains\",\"value\":1,\"next\":{\"hash\":110326007,\"key\":\"there\",\"value\":1}},{\"hash\":-287009735,\"key\":\"unicode\",\"value\":7},{\"hash\":1106799874,\"key\":\"theuniversal\",\"value\":1,\"next\":{\"hash\":3019778,\"key\":\"been\",\"value\":1}},{\"hash\":110326007,\"key\":\"there\",\"value\":1},{\"hash\":-1629331701,\"key\":\"thenbspunicodenbspstandard\",\"value\":1},{\"hash\":114800,\"key\":\"the\",\"value\":3,\"next\":{\"hash\":1379580784,\"key\":\"розроблений\",\"value\":1,\"next\":{\"hash\":-41227408,\"key\":\"посилань\",\"value\":1}}},{\"hash\":3558807,\"key\":\"than\",\"value\":1,\"next\":{\"hash\":329249175,\"key\":\"стандартів\",\"value\":1,\"next\":{\"hash\":-302096489,\"key\":\"комплект\",\"value\":1}}},{\"hash\":3556635,\"key\":\"text\",\"value\":1,\"next\":{\"hash\":1647065627,\"key\":\"repertoire\",\"value\":1}},{\"hash\":-1422419673,\"key\":\"testing\",\"value\":2},{\"hash\":-1737405355,\"key\":\"systems\",\"value\":1,\"next\":{\"hash\":805080917,\"key\":\"юникода\",\"value\":1,\"next\":{\"hash\":-1275837099,\"key\":\"властивостей\",\"value\":1}}},{\"hash\":-1743411762,\"key\":\"symbols\",\"value\":1,\"next\":{\"hash\":-676536882,\"key\":\"складається\",\"value\":1,\"next\":{\"hash\":-1117061682,\"key\":\"компютерних\",\"value\":1}}},{\"hash\":-613938469,\"key\":\"supporting\",\"value\":1},{\"hash\":114253,\"key\":\"sun\",\"value\":1},{\"hash\":1312641152,\"key\":\"standard\",\"value\":2,\"next\":{\"hash\":901557632,\"key\":\"спец-символов\",\"value\":1}},{\"hash\":109442495,\"key\":\"since\",\"value\":1},{\"hash\":113763,\"key\":\"set\",\"value\":1},{\"hash\":-906261105,\"key\":\"second\",\"value\":1},{\"hash\":1926511580,\"key\":\"scripts\",\"value\":1},{\"hash\":108521650,\"key\":\"risen\",\"value\":1,\"next\":{\"hash\":1044498098,\"key\":\"число\",\"value\":1}},{\"hash\":1647065627,\"key\":\"repertoire\",\"value\":1},{\"hash\":1447425963,\"key\":\"published\",\"value\":1},{\"hash\":3433147,\"key\":\"page\",\"value\":2},{\"hash\":3543,\"key\":\"of\",\"value\":2},{\"hash\":3373752,\"key\":\"name\",\"value\":2,\"next\":{\"hash\":1068728,\"key\":\"для\",\"value\":1}},{\"hash\":3357542,\"key\":\"more\",\"value\":1},{\"hash\":-1109904801,\"key\":\"latest\",\"value\":1},{\"hash\":3370,\"key\":\"is\",\"value\":1},{\"hash\":104415,\"key\":\"inc\",\"value\":1},{\"hash\":3365,\"key\":\"in\",\"value\":2,\"next\":{\"hash\":2106950437,\"key\":\"разных\",\"value\":1}},{\"hash\":-1443541794,\"key\":\"high-light\",\"value\":1},{\"hash\":103067,\"key\":\"has\",\"value\":2},{\"hash\":3149044,\"key\":\"form\",\"value\":1},{\"hash\":-1603782120,\"key\":\"english\",\"value\":1},{\"hash\":-80733044,\"key\":\"developed\",\"value\":1},{\"hash\":-351764541,\"key\":\"covering\",\"value\":1,\"next\":{\"hash\":33103811,\"key\":\"году\",\"value\":1}},{\"hash\":-332950906,\"key\":\"consortium\",\"value\":1,\"next\":{\"hash\":-1633678458,\"key\":\"таблиць\",\"value\":1}},{\"hash\":1032937741,\"key\":\"conjunctionwith\",\"value\":1},{\"hash\":707888742,\"key\":\"computing-industry\",\"value\":1,\"next\":{\"hash\":3357542,\"key\":\"more\",\"value\":1}},{\"hash\":1245438033,\"key\":\"characters\",\"value\":1,\"next\":{\"hash\":-1405723055,\"key\":\"закодировать\",\"value\":1}},{\"hash\":1564206610,\"key\":\"character\",\"value\":1,\"next\":{\"hash\":617137426,\"key\":\"становится\",\"value\":1}},{\"hash\":3029703,\"key\":\"book\",\"value\":1,\"next\":{\"hash\":33076423,\"key\":\"всех\",\"value\":1,\"next\":{\"hash\":-1268289081,\"key\":\"нормалізації\",\"value\":1}}},{\"hash\":-1072081724,\"key\":\"beginning\",\"value\":1},{\"hash\":3019778,\"key\":\"been\",\"value\":1},{\"hash\":3122,\"key\":\"as\",\"value\":1,\"next\":{\"hash\":1074,\"key\":\"в\",\"value\":2,\"next\":{\"hash\":1039806770,\"key\":\"текст\",\"value\":1}}},{\"hash\":93030097,\"key\":\"apple\",\"value\":1},{\"hash\":96726,\"key\":\"and\",\"value\":2},{\"hash\":97,\"key\":\"a\",\"value\":2}]],\"listUsersUrls\":[\"http://95.158.60.148:8008/kpl/testingPage.html\"],\"dataTypeResponse\":\"JSON\"}";
        // when
        WordCounterServiceImpl wordCounterService = new WordCounterServiceImpl();
        String actualResult = wordCounterService.getWordCounterResult(clientRequestUrl, sortingParam, dataTypeResponse);

        // then
        Assert.assertEquals(expectedResult, actualResult);
    }

    @Test
    public void testGetWordCounterResult_okUrl_ValAscSort_JsonResp() {
        // given
        final String clientRequestUrl = "http://95.158.60.148:8008/kpl/testingPage.html";
        final String sortingParam = "VALUE_ASCENDING";
        final String dataTypeResponse = "JSON";
        final String expectedResult = "{\"success\":true,\"response\":[[{\"hash\":259927552,\"key\":\"кодовых\",\"value\":1},{\"hash\":1106799874,\"key\":\"theuniversal\",\"value\":1,\"next\":{\"hash\":3019778,\"key\":\"been\",\"value\":1}},{\"hash\":3019778,\"key\":\"been\",\"value\":1},{\"hash\":1865473031,\"key\":\"забезпечити\",\"value\":1},{\"hash\":-1733527799,\"key\":\"позволяет\",\"value\":1},{\"hash\":1841138442,\"key\":\"письменных\",\"value\":1},{\"hash\":-1629331701,\"key\":\"thenbspunicodenbspstandard\",\"value\":1},{\"hash\":1032937741,\"key\":\"conjunctionwith\",\"value\":1},{\"hash\":1445215505,\"key\":\"русском\",\"value\":1},{\"hash\":1564206610,\"key\":\"character\",\"value\":1,\"next\":{\"hash\":617137426,\"key\":\"становится\",\"value\":1}},{\"hash\":617137426,\"key\":\"становится\",\"value\":1},{\"hash\":33882646,\"key\":\"этом\",\"value\":1},{\"hash\":269427991,\"key\":\"соседствовать\",\"value\":1},{\"hash\":-1603782120,\"key\":\"english\",\"value\":1},{\"hash\":3556635,\"key\":\"text\",\"value\":1,\"next\":{\"hash\":1647065627,\"key\":\"repertoire\",\"value\":1}},{\"hash\":1647065627,\"key\":\"repertoire\",\"value\":1},{\"hash\":-983839715,\"key\":\"письменностей\",\"value\":1},{\"hash\":2028455202,\"key\":\"нижній\",\"value\":1},{\"hash\":2106950437,\"key\":\"разных\",\"value\":1},{\"hash\":3370,\"key\":\"is\",\"value\":1},{\"hash\":351602733,\"key\":\"version\",\"value\":1,\"next\":{\"hash\":-774418643,\"key\":\"комплекту\",\"value\":2}},{\"hash\":869231918,\"key\":\"большое\",\"value\":1,\"next\":{\"hash\":1610114606,\"key\":\"чисто-математические\",\"value\":1,\"next\":{\"hash\":34862,\"key\":\"та\",\"value\":2,\"next\":{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}}}}},{\"hash\":1610114606,\"key\":\"чисто-математические\",\"value\":1,\"next\":{\"hash\":34862,\"key\":\"та\",\"value\":2,\"next\":{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}}}},{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}},{\"hash\":1039661102,\"key\":\"таких\",\"value\":1},{\"hash\":3122,\"key\":\"as\",\"value\":1,\"next\":{\"hash\":1074,\"key\":\"в\",\"value\":2,\"next\":{\"hash\":1039806770,\"key\":\"текст\",\"value\":1}}},{\"hash\":1039806770,\"key\":\"текст\",\"value\":1},{\"hash\":1079,\"key\":\"з\",\"value\":1},{\"hash\":31669560,\"key\":\"предложен\",\"value\":1},{\"hash\":252595772,\"key\":\"применение\",\"value\":1,\"next\":{\"hash\":1026733372,\"key\":\"даних\",\"value\":1}},{\"hash\":1026733372,\"key\":\"даних\",\"value\":1},{\"hash\":2078943552,\"key\":\"переключение\",\"value\":1},{\"hash\":-782072253,\"key\":\"worlds\",\"value\":1},{\"hash\":114253,\"key\":\"sun\",\"value\":1},{\"hash\":2065988943,\"key\":\"латиницы\",\"value\":1,\"next\":{\"hash\":259919951,\"key\":\"кодових\",\"value\":1}},{\"hash\":259919951,\"key\":\"кодових\",\"value\":1},{\"hash\":1245438033,\"key\":\"characters\",\"value\":1,\"next\":{\"hash\":-1405723055,\"key\":\"закодировать\",\"value\":1}},{\"hash\":-1405723055,\"key\":\"закодировать\",\"value\":1},{\"hash\":-1737405355,\"key\":\"systems\",\"value\":1,\"next\":{\"hash\":805080917,\"key\":\"юникода\",\"value\":1,\"next\":{\"hash\":-1275837099,\"key\":\"властивостей\",\"value\":1}}},{\"hash\":805080917,\"key\":\"юникода\",\"value\":1,\"next\":{\"hash\":-1275837099,\"key\":\"властивостей\",\"value\":1}},{\"hash\":-1275837099,\"key\":\"властивостей\",\"value\":1},{\"hash\":-1775114666,\"key\":\"юникод\",\"value\":1,\"next\":{\"hash\":1110,\"key\":\"і\",\"value\":2}},{\"hash\":1602987863,\"key\":\"writing\",\"value\":1},{\"hash\":-42949031,\"key\":\"организацией\",\"value\":1,\"next\":{\"hash\":2092908377,\"key\":\"правил\",\"value\":1}},{\"hash\":2092908377,\"key\":\"правил\",\"value\":1},{\"hash\":979911260,\"key\":\"розкладка\",\"value\":1},{\"hash\":-1109904801,\"key\":\"latest\",\"value\":1},{\"hash\":370307170,\"key\":\"спеціальних\",\"value\":1},{\"hash\":113763,\"key\":\"set\",\"value\":1},{\"hash\":1297077348,\"key\":\"алфавита\",\"value\":1},{\"hash\":-2042229147,\"key\":\"китайские\",\"value\":1},{\"hash\":707888742,\"key\":\"computing-industry\",\"value\":1,\"next\":{\"hash\":3357542,\"key\":\"more\",\"value\":1}},{\"hash\":3357542,\"key\":\"more\",\"value\":1},{\"hash\":1079399,\"key\":\"при\",\"value\":1},{\"hash\":80122474,\"key\":\"рендерингу\",\"value\":1},{\"hash\":33541739,\"key\":\"тест\",\"value\":1},{\"hash\":-1264635284,\"key\":\"зіставлення\",\"value\":1},{\"hash\":-1249432465,\"key\":\"уніфіковане\",\"value\":1},{\"hash\":1379580784,\"key\":\"розроблений\",\"value\":1,\"next\":{\"hash\":-41227408,\"key\":\"посилань\",\"value\":1}},{\"hash\":-41227408,\"key\":\"посилань\",\"value\":1},{\"hash\":723850357,\"key\":\"декомпозиції\",\"value\":1},{\"hash\":-1259286410,\"key\":\"документах\",\"value\":1},{\"hash\":2020918647,\"key\":\"набору\",\"value\":1},{\"hash\":-2131828867,\"key\":\"цифрове\",\"value\":1},{\"hash\":929892735,\"key\":\"українською\",\"value\":1},{\"hash\":901557632,\"key\":\"спец-символов\",\"value\":1},{\"hash\":1032113539,\"key\":\"регістр\",\"value\":1},{\"hash\":1503478917,\"key\":\"верхній\",\"value\":1},{\"hash\":-332950906,\"key\":\"consortium\",\"value\":1,\"next\":{\"hash\":-1633678458,\"key\":\"таблиць\",\"value\":1}},{\"hash\":-1633678458,\"key\":\"таблиць\",\"value\":1},{\"hash\":-80733044,\"key\":\"developed\",\"value\":1},{\"hash\":33583501,\"key\":\"усіх\",\"value\":1,\"next\":{\"hash\":1038826637,\"key\":\"світу\",\"value\":1}},{\"hash\":1038826637,\"key\":\"світу\",\"value\":1},{\"hash\":-906261105,\"key\":\"second\",\"value\":1},{\"hash\":-1751463791,\"key\":\"языков\",\"value\":1},{\"hash\":1484929682,\"key\":\"кодирования\",\"value\":1},{\"hash\":1508547221,\"key\":\"представить\",\"value\":1},{\"hash\":3558807,\"key\":\"than\",\"value\":1,\"next\":{\"hash\":329249175,\"key\":\"стандартів\",\"value\":1,\"next\":{\"hash\":-302096489,\"key\":\"комплект\",\"value\":1}}},{\"hash\":329249175,\"key\":\"стандартів\",\"value\":1,\"next\":{\"hash\":-302096489,\"key\":\"комплект\",\"value\":1}},{\"hash\":-302096489,\"key\":\"комплект\",\"value\":1},{\"hash\":708472733,\"key\":\"кириллицы\",\"value\":1,\"next\":{\"hash\":-2137750627,\"key\":\"наприклад\",\"value\":1}},{\"hash\":-2137750627,\"key\":\"наприклад\",\"value\":1},{\"hash\":-740627546,\"key\":\"иероглифы\",\"value\":1},{\"hash\":1436358824,\"key\":\"довідкових\",\"value\":1},{\"hash\":1029880746,\"key\":\"знаки\",\"value\":1,\"next\":{\"hash\":1037317034,\"key\":\"почти\",\"value\":1}},{\"hash\":1037317034,\"key\":\"почти\",\"value\":1},{\"hash\":1447425963,\"key\":\"published\",\"value\":1},{\"hash\":1088940,\"key\":\"щоб\",\"value\":1},{\"hash\":34991,\"key\":\"це\",\"value\":1},{\"hash\":1024517553,\"key\":\"буквы\",\"value\":1},{\"hash\":108521650,\"key\":\"risen\",\"value\":1,\"next\":{\"hash\":1044498098,\"key\":\"число\",\"value\":1}},{\"hash\":1044498098,\"key\":\"число\",\"value\":1},{\"hash\":2023677879,\"key\":\"некоммерческой\",\"value\":1},{\"hash\":1068728,\"key\":\"для\",\"value\":1},{\"hash\":1034502329,\"key\":\"могут\",\"value\":1,\"next\":{\"hash\":2012768441,\"key\":\"символы\",\"value\":1}},{\"hash\":2012768441,\"key\":\"символы\",\"value\":1},{\"hash\":1082688445,\"key\":\"консорциум\",\"value\":1},{\"hash\":-1972631874,\"key\":\"представлення\",\"value\":1},{\"hash\":109442495,\"key\":\"since\",\"value\":1},{\"hash\":-2073376832,\"key\":\"файлів\",\"value\":1},{\"hash\":-351764541,\"key\":\"covering\",\"value\":1,\"next\":{\"hash\":33103811,\"key\":\"году\",\"value\":1}},{\"hash\":33103811,\"key\":\"году\",\"value\":1},{\"hash\":-1072081724,\"key\":\"beginning\",\"value\":1},{\"hash\":3029703,\"key\":\"book\",\"value\":1,\"next\":{\"hash\":33076423,\"key\":\"всех\",\"value\":1,\"next\":{\"hash\":-1268289081,\"key\":\"нормалізації\",\"value\":1}}},{\"hash\":33076423,\"key\":\"всех\",\"value\":1,\"next\":{\"hash\":-1268289081,\"key\":\"нормалізації\",\"value\":1}},{\"hash\":-1268289081,\"key\":\"нормалізації\",\"value\":1},{\"hash\":35275,\"key\":\"як\",\"value\":1},{\"hash\":-1743411762,\"key\":\"symbols\",\"value\":1,\"next\":{\"hash\":-676536882,\"key\":\"складається\",\"value\":1,\"next\":{\"hash\":-1117061682,\"key\":\"компютерних\",\"value\":1}}},{\"hash\":-676536882,\"key\":\"складається\",\"value\":1,\"next\":{\"hash\":-1117061682,\"key\":\"компютерних\",\"value\":1}},{\"hash\":-1117061682,\"key\":\"компютерних\",\"value\":1},{\"hash\":557562319,\"key\":\"позволяющий\",\"value\":1},{\"hash\":93030097,\"key\":\"apple\",\"value\":1},{\"hash\":-1992257574,\"key\":\"страниц\",\"value\":1},{\"hash\":-613938469,\"key\":\"supporting\",\"value\":1},{\"hash\":1926511580,\"key\":\"scripts\",\"value\":1},{\"hash\":-1443541794,\"key\":\"high-light\",\"value\":1},{\"hash\":104415,\"key\":\"inc\",\"value\":1},{\"hash\":-1441253918,\"key\":\"греческого\",\"value\":1},{\"hash\":1265991651,\"key\":\"ненужным\",\"value\":1},{\"hash\":-59324188,\"key\":\"методології\",\"value\":1},{\"hash\":10620902,\"key\":\"стандарта\",\"value\":1},{\"hash\":-231771929,\"key\":\"промисловий\",\"value\":1},{\"hash\":117480,\"key\":\"was\",\"value\":1},{\"hash\":1778577899,\"key\":\"других\",\"value\":1},{\"hash\":1050360815,\"key\":\"этого\",\"value\":1,\"next\":{\"hash\":41579759,\"key\":\"писемностей\",\"value\":1}},{\"hash\":41579759,\"key\":\"писемностей\",\"value\":1},{\"hash\":1036646386,\"key\":\"очень\",\"value\":1},{\"hash\":3149044,\"key\":\"form\",\"value\":1},{\"hash\":236801014,\"key\":\"various\",\"value\":1},{\"hash\":1158383351,\"key\":\"unicodecontains\",\"value\":1,\"next\":{\"hash\":110326007,\"key\":\"there\",\"value\":1}},{\"hash\":110326007,\"key\":\"there\",\"value\":1},{\"hash\":-834353672,\"key\":\"асортименту\",\"value\":1},{\"hash\":34559,\"key\":\"из\",\"value\":1},{\"hash\":3365,\"key\":\"in\",\"value\":2,\"next\":{\"hash\":2106950437,\"key\":\"разных\",\"value\":1}},{\"hash\":-1422419673,\"key\":\"testing\",\"value\":2},{\"hash\":-774418643,\"key\":\"комплекту\",\"value\":2},{\"hash\":34862,\"key\":\"та\",\"value\":2,\"next\":{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}}},{\"hash\":1074,\"key\":\"в\",\"value\":2,\"next\":{\"hash\":1039806770,\"key\":\"текст\",\"value\":1}},{\"hash\":1080,\"key\":\"и\",\"value\":2,\"next\":{\"hash\":31669560,\"key\":\"предложен\",\"value\":1}},{\"hash\":1110,\"key\":\"і\",\"value\":2},{\"hash\":97,\"key\":\"a\",\"value\":2},{\"hash\":-2029302667,\"key\":\"символов\",\"value\":2,\"next\":{\"hash\":723850357,\"key\":\"декомпозиції\",\"value\":1}},{\"hash\":1312641152,\"key\":\"standard\",\"value\":2,\"next\":{\"hash\":901557632,\"key\":\"спец-символов\",\"value\":1}},{\"hash\":935303561,\"key\":\"зображення\",\"value\":2},{\"hash\":34707,\"key\":\"на\",\"value\":2},{\"hash\":103067,\"key\":\"has\",\"value\":2},{\"hash\":-1774221898,\"key\":\"юнікод\",\"value\":2},{\"hash\":3373752,\"key\":\"name\",\"value\":2,\"next\":{\"hash\":1068728,\"key\":\"для\",\"value\":1}},{\"hash\":3433147,\"key\":\"page\",\"value\":2},{\"hash\":96726,\"key\":\"and\",\"value\":2},{\"hash\":3543,\"key\":\"of\",\"value\":2},{\"hash\":821569606,\"key\":\"кодування\",\"value\":3},{\"hash\":-2077833654,\"key\":\"стандарт\",\"value\":3},{\"hash\":114800,\"key\":\"the\",\"value\":3,\"next\":{\"hash\":1379580784,\"key\":\"розроблений\",\"value\":1,\"next\":{\"hash\":-41227408,\"key\":\"посилань\",\"value\":1}}},{\"hash\":33012930,\"key\":\"англ\",\"value\":3},{\"hash\":-2029303443,\"key\":\"символів\",\"value\":6},{\"hash\":-287009735,\"key\":\"unicode\",\"value\":7}]],\"listUsersUrls\":[\"http://95.158.60.148:8008/kpl/testingPage.html\"],\"dataTypeResponse\":\"JSON\"}";
        // when
        WordCounterServiceImpl wordCounterService = new WordCounterServiceImpl();
        String actualResult = wordCounterService.getWordCounterResult(clientRequestUrl, sortingParam, dataTypeResponse);

        // then
        Assert.assertEquals(expectedResult, actualResult);
    }

    @Test
    public void testGetWordCounterResult_okUrl_ValDescSort_JsonResp() {
        // given
        final String clientRequestUrl = "http://95.158.60.148:8008/kpl/testingPage.html";
        final String sortingParam = "VALUE_DESCENDING";
        final String dataTypeResponse = "JSON";
        final String expectedResult = "{\"success\":true,\"response\":[[{\"hash\":-287009735,\"key\":\"unicode\",\"value\":7},{\"hash\":-2029303443,\"key\":\"символів\",\"value\":6},{\"hash\":821569606,\"key\":\"кодування\",\"value\":3},{\"hash\":-2077833654,\"key\":\"стандарт\",\"value\":3},{\"hash\":114800,\"key\":\"the\",\"value\":3,\"next\":{\"hash\":1379580784,\"key\":\"розроблений\",\"value\":1,\"next\":{\"hash\":-41227408,\"key\":\"посилань\",\"value\":1}}},{\"hash\":33012930,\"key\":\"англ\",\"value\":3},{\"hash\":3365,\"key\":\"in\",\"value\":2,\"next\":{\"hash\":2106950437,\"key\":\"разных\",\"value\":1}},{\"hash\":-1422419673,\"key\":\"testing\",\"value\":2},{\"hash\":-774418643,\"key\":\"комплекту\",\"value\":2},{\"hash\":34862,\"key\":\"та\",\"value\":2,\"next\":{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}}},{\"hash\":1074,\"key\":\"в\",\"value\":2,\"next\":{\"hash\":1039806770,\"key\":\"текст\",\"value\":1}},{\"hash\":1080,\"key\":\"и\",\"value\":2,\"next\":{\"hash\":31669560,\"key\":\"предложен\",\"value\":1}},{\"hash\":1110,\"key\":\"і\",\"value\":2},{\"hash\":97,\"key\":\"a\",\"value\":2},{\"hash\":-2029302667,\"key\":\"символов\",\"value\":2,\"next\":{\"hash\":723850357,\"key\":\"декомпозиції\",\"value\":1}},{\"hash\":1312641152,\"key\":\"standard\",\"value\":2,\"next\":{\"hash\":901557632,\"key\":\"спец-символов\",\"value\":1}},{\"hash\":935303561,\"key\":\"зображення\",\"value\":2},{\"hash\":34707,\"key\":\"на\",\"value\":2},{\"hash\":103067,\"key\":\"has\",\"value\":2},{\"hash\":-1774221898,\"key\":\"юнікод\",\"value\":2},{\"hash\":3373752,\"key\":\"name\",\"value\":2,\"next\":{\"hash\":1068728,\"key\":\"для\",\"value\":1}},{\"hash\":3433147,\"key\":\"page\",\"value\":2},{\"hash\":96726,\"key\":\"and\",\"value\":2},{\"hash\":3543,\"key\":\"of\",\"value\":2},{\"hash\":259927552,\"key\":\"кодовых\",\"value\":1},{\"hash\":1106799874,\"key\":\"theuniversal\",\"value\":1,\"next\":{\"hash\":3019778,\"key\":\"been\",\"value\":1}},{\"hash\":3019778,\"key\":\"been\",\"value\":1},{\"hash\":1865473031,\"key\":\"забезпечити\",\"value\":1},{\"hash\":-1733527799,\"key\":\"позволяет\",\"value\":1},{\"hash\":1841138442,\"key\":\"письменных\",\"value\":1},{\"hash\":-1629331701,\"key\":\"thenbspunicodenbspstandard\",\"value\":1},{\"hash\":1032937741,\"key\":\"conjunctionwith\",\"value\":1},{\"hash\":1445215505,\"key\":\"русском\",\"value\":1},{\"hash\":1564206610,\"key\":\"character\",\"value\":1,\"next\":{\"hash\":617137426,\"key\":\"становится\",\"value\":1}},{\"hash\":617137426,\"key\":\"становится\",\"value\":1},{\"hash\":33882646,\"key\":\"этом\",\"value\":1},{\"hash\":269427991,\"key\":\"соседствовать\",\"value\":1},{\"hash\":-1603782120,\"key\":\"english\",\"value\":1},{\"hash\":3556635,\"key\":\"text\",\"value\":1,\"next\":{\"hash\":1647065627,\"key\":\"repertoire\",\"value\":1}},{\"hash\":1647065627,\"key\":\"repertoire\",\"value\":1},{\"hash\":-983839715,\"key\":\"письменностей\",\"value\":1},{\"hash\":2028455202,\"key\":\"нижній\",\"value\":1},{\"hash\":2106950437,\"key\":\"разных\",\"value\":1},{\"hash\":3370,\"key\":\"is\",\"value\":1},{\"hash\":351602733,\"key\":\"version\",\"value\":1,\"next\":{\"hash\":-774418643,\"key\":\"комплекту\",\"value\":2}},{\"hash\":869231918,\"key\":\"большое\",\"value\":1,\"next\":{\"hash\":1610114606,\"key\":\"чисто-математические\",\"value\":1,\"next\":{\"hash\":34862,\"key\":\"та\",\"value\":2,\"next\":{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}}}}},{\"hash\":1610114606,\"key\":\"чисто-математические\",\"value\":1,\"next\":{\"hash\":34862,\"key\":\"та\",\"value\":2,\"next\":{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}}}},{\"hash\":-2145502930,\"key\":\"списку\",\"value\":1,\"next\":{\"hash\":1039661102,\"key\":\"таких\",\"value\":1}},{\"hash\":1039661102,\"key\":\"таких\",\"value\":1},{\"hash\":3122,\"key\":\"as\",\"value\":1,\"next\":{\"hash\":1074,\"key\":\"в\",\"value\":2,\"next\":{\"hash\":1039806770,\"key\":\"текст\",\"value\":1}}},{\"hash\":1039806770,\"key\":\"текст\",\"value\":1},{\"hash\":1079,\"key\":\"з\",\"value\":1},{\"hash\":31669560,\"key\":\"предложен\",\"value\":1},{\"hash\":252595772,\"key\":\"применение\",\"value\":1,\"next\":{\"hash\":1026733372,\"key\":\"даних\",\"value\":1}},{\"hash\":1026733372,\"key\":\"даних\",\"value\":1},{\"hash\":2078943552,\"key\":\"переключение\",\"value\":1},{\"hash\":-782072253,\"key\":\"worlds\",\"value\":1},{\"hash\":114253,\"key\":\"sun\",\"value\":1},{\"hash\":2065988943,\"key\":\"латиницы\",\"value\":1,\"next\":{\"hash\":259919951,\"key\":\"кодових\",\"value\":1}},{\"hash\":259919951,\"key\":\"кодових\",\"value\":1},{\"hash\":1245438033,\"key\":\"characters\",\"value\":1,\"next\":{\"hash\":-1405723055,\"key\":\"закодировать\",\"value\":1}},{\"hash\":-1405723055,\"key\":\"закодировать\",\"value\":1},{\"hash\":-1737405355,\"key\":\"systems\",\"value\":1,\"next\":{\"hash\":805080917,\"key\":\"юникода\",\"value\":1,\"next\":{\"hash\":-1275837099,\"key\":\"властивостей\",\"value\":1}}},{\"hash\":805080917,\"key\":\"юникода\",\"value\":1,\"next\":{\"hash\":-1275837099,\"key\":\"властивостей\",\"value\":1}},{\"hash\":-1275837099,\"key\":\"властивостей\",\"value\":1},{\"hash\":-1775114666,\"key\":\"юникод\",\"value\":1,\"next\":{\"hash\":1110,\"key\":\"і\",\"value\":2}},{\"hash\":1602987863,\"key\":\"writing\",\"value\":1},{\"hash\":-42949031,\"key\":\"организацией\",\"value\":1,\"next\":{\"hash\":2092908377,\"key\":\"правил\",\"value\":1}},{\"hash\":2092908377,\"key\":\"правил\",\"value\":1},{\"hash\":979911260,\"key\":\"розкладка\",\"value\":1},{\"hash\":-1109904801,\"key\":\"latest\",\"value\":1},{\"hash\":370307170,\"key\":\"спеціальних\",\"value\":1},{\"hash\":113763,\"key\":\"set\",\"value\":1},{\"hash\":1297077348,\"key\":\"алфавита\",\"value\":1},{\"hash\":-2042229147,\"key\":\"китайские\",\"value\":1},{\"hash\":707888742,\"key\":\"computing-industry\",\"value\":1,\"next\":{\"hash\":3357542,\"key\":\"more\",\"value\":1}},{\"hash\":3357542,\"key\":\"more\",\"value\":1},{\"hash\":1079399,\"key\":\"при\",\"value\":1},{\"hash\":80122474,\"key\":\"рендерингу\",\"value\":1},{\"hash\":33541739,\"key\":\"тест\",\"value\":1},{\"hash\":-1264635284,\"key\":\"зіставлення\",\"value\":1},{\"hash\":-1249432465,\"key\":\"уніфіковане\",\"value\":1},{\"hash\":1379580784,\"key\":\"розроблений\",\"value\":1,\"next\":{\"hash\":-41227408,\"key\":\"посилань\",\"value\":1}},{\"hash\":-41227408,\"key\":\"посилань\",\"value\":1},{\"hash\":723850357,\"key\":\"декомпозиції\",\"value\":1},{\"hash\":-1259286410,\"key\":\"документах\",\"value\":1},{\"hash\":2020918647,\"key\":\"набору\",\"value\":1},{\"hash\":-2131828867,\"key\":\"цифрове\",\"value\":1},{\"hash\":929892735,\"key\":\"українською\",\"value\":1},{\"hash\":901557632,\"key\":\"спец-символов\",\"value\":1},{\"hash\":1032113539,\"key\":\"регістр\",\"value\":1},{\"hash\":1503478917,\"key\":\"верхній\",\"value\":1},{\"hash\":-332950906,\"key\":\"consortium\",\"value\":1,\"next\":{\"hash\":-1633678458,\"key\":\"таблиць\",\"value\":1}},{\"hash\":-1633678458,\"key\":\"таблиць\",\"value\":1},{\"hash\":-80733044,\"key\":\"developed\",\"value\":1},{\"hash\":33583501,\"key\":\"усіх\",\"value\":1,\"next\":{\"hash\":1038826637,\"key\":\"світу\",\"value\":1}},{\"hash\":1038826637,\"key\":\"світу\",\"value\":1},{\"hash\":-906261105,\"key\":\"second\",\"value\":1},{\"hash\":-1751463791,\"key\":\"языков\",\"value\":1},{\"hash\":1484929682,\"key\":\"кодирования\",\"value\":1},{\"hash\":1508547221,\"key\":\"представить\",\"value\":1},{\"hash\":3558807,\"key\":\"than\",\"value\":1,\"next\":{\"hash\":329249175,\"key\":\"стандартів\",\"value\":1,\"next\":{\"hash\":-302096489,\"key\":\"комплект\",\"value\":1}}},{\"hash\":329249175,\"key\":\"стандартів\",\"value\":1,\"next\":{\"hash\":-302096489,\"key\":\"комплект\",\"value\":1}},{\"hash\":-302096489,\"key\":\"комплект\",\"value\":1},{\"hash\":708472733,\"key\":\"кириллицы\",\"value\":1,\"next\":{\"hash\":-2137750627,\"key\":\"наприклад\",\"value\":1}},{\"hash\":-2137750627,\"key\":\"наприклад\",\"value\":1},{\"hash\":-740627546,\"key\":\"иероглифы\",\"value\":1},{\"hash\":1436358824,\"key\":\"довідкових\",\"value\":1},{\"hash\":1029880746,\"key\":\"знаки\",\"value\":1,\"next\":{\"hash\":1037317034,\"key\":\"почти\",\"value\":1}},{\"hash\":1037317034,\"key\":\"почти\",\"value\":1},{\"hash\":1447425963,\"key\":\"published\",\"value\":1},{\"hash\":1088940,\"key\":\"щоб\",\"value\":1},{\"hash\":34991,\"key\":\"це\",\"value\":1},{\"hash\":1024517553,\"key\":\"буквы\",\"value\":1},{\"hash\":108521650,\"key\":\"risen\",\"value\":1,\"next\":{\"hash\":1044498098,\"key\":\"число\",\"value\":1}},{\"hash\":1044498098,\"key\":\"число\",\"value\":1},{\"hash\":2023677879,\"key\":\"некоммерческой\",\"value\":1},{\"hash\":1068728,\"key\":\"для\",\"value\":1},{\"hash\":1034502329,\"key\":\"могут\",\"value\":1,\"next\":{\"hash\":2012768441,\"key\":\"символы\",\"value\":1}},{\"hash\":2012768441,\"key\":\"символы\",\"value\":1},{\"hash\":1082688445,\"key\":\"консорциум\",\"value\":1},{\"hash\":-1972631874,\"key\":\"представлення\",\"value\":1},{\"hash\":109442495,\"key\":\"since\",\"value\":1},{\"hash\":-2073376832,\"key\":\"файлів\",\"value\":1},{\"hash\":-351764541,\"key\":\"covering\",\"value\":1,\"next\":{\"hash\":33103811,\"key\":\"году\",\"value\":1}},{\"hash\":33103811,\"key\":\"году\",\"value\":1},{\"hash\":-1072081724,\"key\":\"beginning\",\"value\":1},{\"hash\":3029703,\"key\":\"book\",\"value\":1,\"next\":{\"hash\":33076423,\"key\":\"всех\",\"value\":1,\"next\":{\"hash\":-1268289081,\"key\":\"нормалізації\",\"value\":1}}},{\"hash\":33076423,\"key\":\"всех\",\"value\":1,\"next\":{\"hash\":-1268289081,\"key\":\"нормалізації\",\"value\":1}},{\"hash\":-1268289081,\"key\":\"нормалізації\",\"value\":1},{\"hash\":35275,\"key\":\"як\",\"value\":1},{\"hash\":-1743411762,\"key\":\"symbols\",\"value\":1,\"next\":{\"hash\":-676536882,\"key\":\"складається\",\"value\":1,\"next\":{\"hash\":-1117061682,\"key\":\"компютерних\",\"value\":1}}},{\"hash\":-676536882,\"key\":\"складається\",\"value\":1,\"next\":{\"hash\":-1117061682,\"key\":\"компютерних\",\"value\":1}},{\"hash\":-1117061682,\"key\":\"компютерних\",\"value\":1},{\"hash\":557562319,\"key\":\"позволяющий\",\"value\":1},{\"hash\":93030097,\"key\":\"apple\",\"value\":1},{\"hash\":-1992257574,\"key\":\"страниц\",\"value\":1},{\"hash\":-613938469,\"key\":\"supporting\",\"value\":1},{\"hash\":1926511580,\"key\":\"scripts\",\"value\":1},{\"hash\":-1443541794,\"key\":\"high-light\",\"value\":1},{\"hash\":104415,\"key\":\"inc\",\"value\":1},{\"hash\":-1441253918,\"key\":\"греческого\",\"value\":1},{\"hash\":1265991651,\"key\":\"ненужным\",\"value\":1},{\"hash\":-59324188,\"key\":\"методології\",\"value\":1},{\"hash\":10620902,\"key\":\"стандарта\",\"value\":1},{\"hash\":-231771929,\"key\":\"промисловий\",\"value\":1},{\"hash\":117480,\"key\":\"was\",\"value\":1},{\"hash\":1778577899,\"key\":\"других\",\"value\":1},{\"hash\":1050360815,\"key\":\"этого\",\"value\":1,\"next\":{\"hash\":41579759,\"key\":\"писемностей\",\"value\":1}},{\"hash\":41579759,\"key\":\"писемностей\",\"value\":1},{\"hash\":1036646386,\"key\":\"очень\",\"value\":1},{\"hash\":3149044,\"key\":\"form\",\"value\":1},{\"hash\":236801014,\"key\":\"various\",\"value\":1},{\"hash\":1158383351,\"key\":\"unicodecontains\",\"value\":1,\"next\":{\"hash\":110326007,\"key\":\"there\",\"value\":1}},{\"hash\":110326007,\"key\":\"there\",\"value\":1},{\"hash\":-834353672,\"key\":\"асортименту\",\"value\":1},{\"hash\":34559,\"key\":\"из\",\"value\":1}]],\"listUsersUrls\":[\"http://95.158.60.148:8008/kpl/testingPage.html\"],\"dataTypeResponse\":\"JSON\"}";
        // when
        WordCounterServiceImpl wordCounterService = new WordCounterServiceImpl();
        String actualResult = wordCounterService.getWordCounterResult(clientRequestUrl, sortingParam, dataTypeResponse);

        // then
        Assert.assertEquals(expectedResult, actualResult);
    }

    @Test
    public void testGetWordCounterResult_okUrl_InvalidSort_JsonResp() {
        // given
        final String clientRequestUrl = "http://95.158.60.148:8008/kpl/testingPage.html";
        final String sortingParam = "invalidSortingParam";
        final String dataTypeResponse = "JSON";
        final String expctedExceptionString = "java.lang.IllegalArgumentException: No enum constant com.qalight.javacourse.core.WordResultSorter.invalidSortingParam";

        // when
        WordCounterServiceImpl wordCounterService = new WordCounterServiceImpl();
        Exception actualException = null;
        try {
            wordCounterService.getWordCounterResult(clientRequestUrl, sortingParam, dataTypeResponse);
        } catch (RuntimeException e) {
            actualException = e;
        }

        // then
        if (actualException != null) {
            Assert.assertEquals(expctedExceptionString, actualException.toString());
        } else {
            Assert.assertFalse(true);
        }
    }

    @Test
    public void testGetWordCounterResult_okUrl_KeyAscSort_InvalidResp() {
        // given
        final String clientRequestUrl = "http://95.158.60.148:8008/kpl/testingPage.html";
        final String sortingParam = "KEY_ASCENDING";
        final String dataTypeResponse = "invalidResponseParam";
        final String expctedExceptionString = "java.lang.IllegalArgumentException: No enum constant com.qalight.javacourse.service.ResultPresentation.invalidResponseParam";

        // when
        WordCounterServiceImpl wordCounterService = new WordCounterServiceImpl();
        Exception actualException = null;
        try {
            wordCounterService.getWordCounterResult(clientRequestUrl, sortingParam, dataTypeResponse);
        } catch (RuntimeException e) {
            actualException = e;
        }

        // then
        if (actualException != null) {
            Assert.assertEquals(expctedExceptionString, actualException.toString());
        } else {
            Assert.assertFalse(true);
        }
    }
}